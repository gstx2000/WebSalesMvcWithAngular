<div class="container">
  <form method="post" enctype="multipart/form-data" asp-controller="ProductsController" asp-action="Create" asp-antiforgery="true" [formGroup]="productForm" (ngSubmit)="onSubmit()">
    <h2>Cadastro de produto</h2>
    <br />
    <mat-form-field appearance="outline">
      <mat-label for="name">Nome</mat-label>
      <input matInput type="text" id="name" formControlName="name" required>
    </mat-form-field>

    <br />

    <mat-form-field appearance="outline" floatLabel="always">
      <mat-label>Preço</mat-label>
      <input matInput type="number" id="price" formControlName="price" placeholder="0">
      <span matTextPrefix>$&nbsp;</span>
    </mat-form-field>

    <br />

    <mat-form-field appearance="outline">
      <mat-label for="description">Descrição</mat-label>
      <input matInput type="text" id="description" formControlName="description">
    </mat-form-field>

    <br />

    <mat-form-field appearance="outline">
      <mat-label for="imageUrl">Imagem</mat-label>
      <input matInput type="text" id="imageUrl" formControlName="imageUrl">
    </mat-form-field>

    <br />

    <mat-form-field appearance="outline">
      <mat-label for="department$">Departamento</mat-label>
      <mat-select id="departments$" formControlName="departmentId">
        <mat-option *ngFor="let department of departments$ | async" [value]=department.id>{{ department.name }}</mat-option>
      </mat-select>
    </mat-form-field>

    <br />

    <mat-form-field appearance="outline">
      <mat-label for="categories$">Categoria</mat-label>
      <mat-select id="categories$" formControlName="categoryId">
        <mat-option *ngFor="let category of categories$ | async" [value]=category.id>{{ category.name }} </mat-option>
      </mat-select>
      <br />
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label for="subcategories$">Subcategoria</mat-label>
      <mat-select id="subcategories$" formControlName="subcategoryId">
        <mat-option *ngFor="let subcategory of subcategories$ | async" [value]="subcategory.id">{{ subcategory.name }}</mat-option>
      </mat-select>
      <br />
    </mat-form-field>

    <br />

    <mat-form-field appearance="outline" class="input">
      <mat-label for="um">Unidade de estoque</mat-label>
      <mat-select id="um" formControlName="inventoryUnitMeas">
        <mat-option *ngFor="let um of getUnitMeasValues()" [value]="um">
          {{ getUnitMeasName(um) }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <br />

    <input type="file" id="imageFile" (change)="onFileSelected($event)" style="display: none;">
    <button class="btn btn-default" type="button" (click)="triggerFileInput()">
      Escolher Imagem
      <mat-icon class="icon">
        arrow_circle_down
      </mat-icon>
    </button>

    <br />

    <div class="button-container">
      <button type="submit" class="btn btn-default">Cadastrar</button>
      <button class="btn btn-default" [routerLink]="['/products']">Cancelar</button>
    </div>
  </form>

  <div class="image" *ngIf="selectedFile">
    <mat-card class="card">
      <h3>Imagem selecionada:</h3>
      <div class="image-container">
        <img [src]="selectedFile" alt="Imagem do produto" />
        <span *ngIf="selectedFileName">{{ selectedFileName }}</span>
      </div>
    </mat-card>
  </div>

</div>
